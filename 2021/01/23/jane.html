<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Title | Jaekang AI</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Title" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="‚ù§" />
<meta property="og:description" content="‚ù§" />
<link rel="canonical" href="https://leejaeka.github.io/jaekangai/2021/01/23/jane.html" />
<meta property="og:url" content="https://leejaeka.github.io/jaekangai/2021/01/23/jane.html" />
<meta property="og:site_name" content="Jaekang AI" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-23T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://leejaeka.github.io/jaekangai/2021/01/23/jane.html","@type":"BlogPosting","headline":"Title","dateModified":"2021-01-23T00:00:00-06:00","datePublished":"2021-01-23T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leejaeka.github.io/jaekangai/2021/01/23/jane.html"},"description":"‚ù§","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/jaekangai/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://leejaeka.github.io/jaekangai/feed.xml" title="Jaekang AI" /><link rel="shortcut icon" type="image/x-icon" href="/jaekangai/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/jaekangai/">Jaekang AI</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/jaekangai/about/">About Me</a><a class="page-link" href="/jaekangai/search/">Search</a><a class="page-link" href="/jaekangai/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Title</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-01-23T00:00:00-06:00" itemprop="datePublished">
        Jan 23, 2021
      </time>
       ‚Ä¢ <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/leejaeka/jaekangai/tree/master/_notebooks/2021-01-23-jane.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/jaekangai/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/leejaeka/jaekangai/master?filepath=_notebooks%2F2021-01-23-jane.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/jaekangai/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/leejaeka/jaekangai/blob/master/_notebooks/2021-01-23-jane.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/jaekangai/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-01-23-jane.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Problem: Maximize profit by choosing to take a trading opportunity or not using 130 anonymized features</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Import-Library">Import Library<a class="anchor-link" href="#Import-Library"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">datatable</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="c1"># garbage collector to keep RAM in check</span>
<span class="kn">import</span> <span class="nn">gc</span> 
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">os</span>
<span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;/kaggle/input&#39;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style type="text/css">
.datatable table.frame { margin-bottom: 0; }
.datatable table.frame thead { border-bottom: none; }
.datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}
.datatable .bool    { background: #DDDD99; }
.datatable .object  { background: #565656; }
.datatable .int     { background: #5D9E5D; }
.datatable .float   { background: #4040CC; }
.datatable .str     { background: #CC4040; }
.datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}
.datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}
.datatable th:nth-child(2) { padding-left: 12px; }
.datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}
.datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}
.datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}
.datatable .footer { font-size: 9px; }
.datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}
</style>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Import-Data">Import Data<a class="anchor-link" href="#Import-Data"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">fread</span><span class="p">(</span><span class="s1">&#39;../input/train.csv&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../input/features.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>df.shape: (2390491, 138)
how many days? 500days
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>weight</th>
      <th>resp_1</th>
      <th>resp_2</th>
      <th>resp_3</th>
      <th>resp_4</th>
      <th>resp</th>
      <th>feature_0</th>
      <th>feature_1</th>
      <th>feature_2</th>
      <th>...</th>
      <th>feature_121</th>
      <th>feature_122</th>
      <th>feature_123</th>
      <th>feature_124</th>
      <th>feature_125</th>
      <th>feature_126</th>
      <th>feature_127</th>
      <th>feature_128</th>
      <th>feature_129</th>
      <th>ts_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.000000</td>
      <td>0.009916</td>
      <td>0.014079</td>
      <td>0.008773</td>
      <td>0.001390</td>
      <td>0.006270</td>
      <td>1</td>
      <td>-1.872746</td>
      <td>-2.191242</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.168391</td>
      <td>8.313583</td>
      <td>1.782433</td>
      <td>14.018213</td>
      <td>2.653056</td>
      <td>12.600292</td>
      <td>2.301488</td>
      <td>11.445807</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>16.673515</td>
      <td>-0.002828</td>
      <td>-0.003226</td>
      <td>-0.007319</td>
      <td>-0.011114</td>
      <td>-0.009792</td>
      <td>-1</td>
      <td>-1.349537</td>
      <td>-1.704709</td>
      <td>...</td>
      <td>NaN</td>
      <td>-1.178850</td>
      <td>1.777472</td>
      <td>-0.915458</td>
      <td>2.831612</td>
      <td>-1.417010</td>
      <td>2.297459</td>
      <td>-1.304614</td>
      <td>1.898684</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0.000000</td>
      <td>0.025134</td>
      <td>0.027607</td>
      <td>0.033406</td>
      <td>0.034380</td>
      <td>0.023970</td>
      <td>-1</td>
      <td>0.812780</td>
      <td>-0.256156</td>
      <td>...</td>
      <td>NaN</td>
      <td>6.115747</td>
      <td>9.667908</td>
      <td>5.542871</td>
      <td>11.671595</td>
      <td>7.281757</td>
      <td>10.060014</td>
      <td>6.638248</td>
      <td>9.427299</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0.000000</td>
      <td>-0.004730</td>
      <td>-0.003273</td>
      <td>-0.000461</td>
      <td>-0.000476</td>
      <td>-0.003200</td>
      <td>-1</td>
      <td>1.174378</td>
      <td>0.344640</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.838853</td>
      <td>0.499251</td>
      <td>3.033732</td>
      <td>1.513488</td>
      <td>4.397532</td>
      <td>1.266037</td>
      <td>3.856384</td>
      <td>1.013469</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0.138531</td>
      <td>0.001252</td>
      <td>0.002165</td>
      <td>-0.001215</td>
      <td>-0.006219</td>
      <td>-0.002604</td>
      <td>1</td>
      <td>-3.172026</td>
      <td>-3.093182</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.344850</td>
      <td>4.101145</td>
      <td>0.614252</td>
      <td>6.623456</td>
      <td>0.800129</td>
      <td>5.233243</td>
      <td>0.362636</td>
      <td>3.926633</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows √ó 138 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>weight</th>
      <th>resp_1</th>
      <th>resp_2</th>
      <th>resp_3</th>
      <th>resp_4</th>
      <th>resp</th>
      <th>feature_0</th>
      <th>feature_1</th>
      <th>feature_2</th>
      <th>...</th>
      <th>feature_121</th>
      <th>feature_122</th>
      <th>feature_123</th>
      <th>feature_124</th>
      <th>feature_125</th>
      <th>feature_126</th>
      <th>feature_127</th>
      <th>feature_128</th>
      <th>feature_129</th>
      <th>ts_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>2.390491e+06</td>
      <td>...</td>
      <td>2.320637e+06</td>
      <td>2.390268e+06</td>
      <td>2.390268e+06</td>
      <td>2.374408e+06</td>
      <td>2.374408e+06</td>
      <td>2.381638e+06</td>
      <td>2.381638e+06</td>
      <td>2.388570e+06</td>
      <td>2.388570e+06</td>
      <td>2.390491e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.478668e+02</td>
      <td>3.031535e+00</td>
      <td>1.434969e-04</td>
      <td>1.980749e-04</td>
      <td>2.824183e-04</td>
      <td>4.350201e-04</td>
      <td>4.083113e-04</td>
      <td>9.838565e-03</td>
      <td>3.855776e-01</td>
      <td>3.576875e-01</td>
      <td>...</td>
      <td>2.687757e-01</td>
      <td>3.435523e-01</td>
      <td>2.799973e-01</td>
      <td>3.351537e-01</td>
      <td>2.448752e-01</td>
      <td>3.391778e-01</td>
      <td>2.323809e-01</td>
      <td>3.425608e-01</td>
      <td>2.456182e-01</td>
      <td>1.195245e+06</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.522746e+02</td>
      <td>7.672794e+00</td>
      <td>8.930163e-03</td>
      <td>1.230236e-02</td>
      <td>1.906882e-02</td>
      <td>3.291224e-02</td>
      <td>2.693609e-02</td>
      <td>9.999518e-01</td>
      <td>2.559373e+00</td>
      <td>2.477335e+00</td>
      <td>...</td>
      <td>2.174238e+00</td>
      <td>2.087842e+00</td>
      <td>1.977643e+00</td>
      <td>1.742587e+00</td>
      <td>2.242853e+00</td>
      <td>2.534498e+00</td>
      <td>1.795854e+00</td>
      <td>2.307130e+00</td>
      <td>1.765419e+00</td>
      <td>6.900755e+05</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>-3.675043e-01</td>
      <td>-5.328334e-01</td>
      <td>-5.681196e-01</td>
      <td>-5.987447e-01</td>
      <td>-5.493845e-01</td>
      <td>-1.000000e+00</td>
      <td>-3.172026e+00</td>
      <td>-3.093182e+00</td>
      <td>...</td>
      <td>-7.471971e+00</td>
      <td>-5.862979e+00</td>
      <td>-6.029281e+00</td>
      <td>-4.080720e+00</td>
      <td>-8.136407e+00</td>
      <td>-8.215050e+00</td>
      <td>-5.765982e+00</td>
      <td>-7.024909e+00</td>
      <td>-5.282181e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.040000e+02</td>
      <td>1.617400e-01</td>
      <td>-1.859162e-03</td>
      <td>-2.655044e-03</td>
      <td>-5.030704e-03</td>
      <td>-9.310415e-03</td>
      <td>-7.157903e-03</td>
      <td>-1.000000e+00</td>
      <td>-1.299334e+00</td>
      <td>-1.263628e+00</td>
      <td>...</td>
      <td>-1.123252e+00</td>
      <td>-1.114326e+00</td>
      <td>-9.512009e-01</td>
      <td>-9.133750e-01</td>
      <td>-1.212124e+00</td>
      <td>-1.452912e+00</td>
      <td>-8.993050e-01</td>
      <td>-1.278341e+00</td>
      <td>-8.544535e-01</td>
      <td>5.976225e+05</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.540000e+02</td>
      <td>7.086770e-01</td>
      <td>4.552665e-05</td>
      <td>6.928179e-05</td>
      <td>1.164734e-04</td>
      <td>1.222579e-04</td>
      <td>8.634997e-05</td>
      <td>1.000000e+00</td>
      <td>-1.870182e-05</td>
      <td>-7.200577e-07</td>
      <td>...</td>
      <td>0.000000e+00</td>
      <td>7.006233e-17</td>
      <td>6.054629e-17</td>
      <td>4.870826e-17</td>
      <td>-2.558675e-16</td>
      <td>1.015055e-16</td>
      <td>5.419920e-17</td>
      <td>8.563069e-17</td>
      <td>4.869529e-17</td>
      <td>1.195245e+06</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.820000e+02</td>
      <td>2.471791e+00</td>
      <td>2.097469e-03</td>
      <td>2.939111e-03</td>
      <td>5.466336e-03</td>
      <td>9.804649e-03</td>
      <td>7.544347e-03</td>
      <td>1.000000e+00</td>
      <td>1.578417e+00</td>
      <td>1.526399e+00</td>
      <td>...</td>
      <td>1.342829e+00</td>
      <td>1.405926e+00</td>
      <td>1.308625e+00</td>
      <td>1.228277e+00</td>
      <td>1.409687e+00</td>
      <td>1.767275e+00</td>
      <td>1.111491e+00</td>
      <td>1.582633e+00</td>
      <td>1.125321e+00</td>
      <td>1.792868e+06</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.990000e+02</td>
      <td>1.672937e+02</td>
      <td>2.453477e-01</td>
      <td>2.949339e-01</td>
      <td>3.265597e-01</td>
      <td>5.113795e-01</td>
      <td>4.484616e-01</td>
      <td>1.000000e+00</td>
      <td>7.442989e+01</td>
      <td>1.480763e+02</td>
      <td>...</td>
      <td>1.107771e+02</td>
      <td>4.812516e+01</td>
      <td>1.276908e+02</td>
      <td>6.514517e+01</td>
      <td>7.052807e+01</td>
      <td>5.872849e+01</td>
      <td>6.932221e+01</td>
      <td>5.119038e+01</td>
      <td>1.164568e+02</td>
      <td>2.390490e+06</td>
    </tr>
  </tbody>
</table>
<p>8 rows √ó 138 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feat</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>tag_0</th>
      <th>tag_1</th>
      <th>tag_2</th>
      <th>tag_3</th>
      <th>tag_4</th>
      <th>tag_5</th>
      <th>tag_6</th>
      <th>tag_7</th>
      <th>tag_8</th>
      <th>...</th>
      <th>tag_19</th>
      <th>tag_20</th>
      <th>tag_21</th>
      <th>tag_22</th>
      <th>tag_23</th>
      <th>tag_24</th>
      <th>tag_25</th>
      <th>tag_26</th>
      <th>tag_27</th>
      <th>tag_28</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>...</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
      <td>130</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>130</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>top</th>
      <td>feature_72</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>113</td>
      <td>113</td>
      <td>113</td>
      <td>113</td>
      <td>113</td>
      <td>122</td>
      <td>90</td>
      <td>128</td>
      <td>128</td>
      <td>...</td>
      <td>123</td>
      <td>125</td>
      <td>125</td>
      <td>121</td>
      <td>82</td>
      <td>118</td>
      <td>118</td>
      <td>118</td>
      <td>118</td>
      <td>118</td>
    </tr>
  </tbody>
</table>
<p>4 rows √ó 30 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cleaning-Data">Cleaning Data<a class="anchor-link" href="#Cleaning-Data"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 88 many cols with at least one null value
{&#39;feature_108&#39;, &#39;feature_91&#39;, &#39;feature_115&#39;, &#39;feature_128&#39;, &#39;feature_93&#39;, &#39;feature_33&#39;, &#39;feature_24&#39;, &#39;feature_4&#39;, &#39;feature_79&#39;, &#39;feature_28&#39;, &#39;feature_19&#39;, &#39;feature_88&#39;, &#39;feature_56&#39;, &#39;feature_117&#39;, &#39;feature_31&#39;, &#39;feature_21&#39;, &#39;feature_7&#39;, &#39;feature_94&#39;, &#39;feature_16&#39;, &#39;feature_76&#39;, &#39;feature_96&#39;, &#39;feature_12&#39;, &#39;feature_55&#39;, &#39;feature_29&#39;, &#39;feature_120&#39;, &#39;feature_35&#39;, &#39;feature_124&#39;, &#39;feature_32&#39;, &#39;feature_74&#39;, &#39;feature_17&#39;, &#39;feature_116&#39;, &#39;feature_97&#39;, &#39;feature_86&#39;, &#39;feature_105&#39;, &#39;feature_127&#39;, &#39;feature_36&#39;, &#39;feature_99&#39;, &#39;feature_34&#39;, &#39;feature_104&#39;, &#39;feature_10&#39;, &#39;feature_100&#39;, &#39;feature_58&#39;, &#39;feature_87&#39;, &#39;feature_111&#39;, &#39;feature_122&#39;, &#39;feature_80&#39;, &#39;feature_78&#39;, &#39;feature_25&#39;, &#39;feature_18&#39;, &#39;feature_59&#39;, &#39;feature_26&#39;, &#39;feature_73&#39;, &#39;feature_92&#39;, &#39;feature_15&#39;, &#39;feature_81&#39;, &#39;feature_27&#39;, &#39;feature_13&#39;, &#39;feature_112&#39;, &#39;feature_109&#39;, &#39;feature_125&#39;, &#39;feature_3&#39;, &#39;feature_98&#39;, &#39;feature_82&#39;, &#39;feature_84&#39;, &#39;feature_45&#39;, &#39;feature_90&#39;, &#39;feature_9&#39;, &#39;feature_8&#39;, &#39;feature_118&#39;, &#39;feature_75&#39;, &#39;feature_123&#39;, &#39;feature_22&#39;, &#39;feature_11&#39;, &#39;feature_23&#39;, &#39;feature_44&#39;, &#39;feature_20&#39;, &#39;feature_114&#39;, &#39;feature_106&#39;, &#39;feature_14&#39;, &#39;feature_102&#39;, &#39;feature_129&#39;, &#39;feature_110&#39;, &#39;feature_85&#39;, &#39;feature_126&#39;, &#39;feature_121&#39;, &#39;feature_30&#39;, &#39;feature_103&#39;, &#39;feature_72&#39;}
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A lot of the histogram with null values has extreme outliers. It would be safe to fill the null values with medians. Other imputation method considered were mean and KNN-Imputation. Check out my other notebook where KNN-Imputation was used to train MLP.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we just remove all nans, we would be removing more than 16.54% of the dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Interesting points so far:</p>
<ul>
<li>feature_0 is binary.</li>
<li>A lot of features seems to be normally distributed.</li>
<li>A lot of missing values. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plots-&amp;-Visualization">Plots &amp; Visualization<a class="anchor-link" href="#Plots-&amp;-Visualization"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="resp,-resp_1,-resp_2,-resp_3,-resp_4">resp, resp_1, resp_2, resp_3, resp_4<a class="anchor-link" href="#resp,-resp_1,-resp_2,-resp_3,-resp_4"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that resp is closely related to resp_4 (blue and purple). Resp_1 and resp_2 also seem to be closely related but much much linear. Resp_3 seem to be in the middle, where the shape is closer to upper group but position is slightly closer to green and orange.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Weights">Weights<a class="anchor-link" href="#Weights"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note: <strong>weight</strong> and <strong>resp</strong> multiplied together represents a return on the trade.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that most weights are around 0.2 and we can see two 'peaks' which is around 0.2 and 0.3. Note that maximum weight was 167.29 represented by 1.0 on x-axis. Thus 0.2 represents around 33.458 and 0.3 represents around 50.187.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the graph plots all the positive gains. (Our 1's for our action column). So we can see that there were 'bigger' gains in the beginning and as time approach 500, the gain becomes smaller. In conclusion, the earlier trades are much bigger but we don't know what it's going to be like in our competition test set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We know that we probability want to invest more 'weight' if there are bigger 'resp'(return). We learn here that higher weights are only when resp is close to 0. In other words, it is dumb to trade if resp is away from 0 but it is safe to invest even a lot if it is near 0.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the Kaggle community, there's been lots of discussion on how the trends changed significantly since day ~85. We can see much more trades happening before day 100. Rest of the days are still very active but not as noisy. We can suggest that there has been a change of trading model from Jane Street as discussed <a href="https://www.kaggle.com/c/jane-street-market-prediction/discussion/201930">here</a> by <a href="https://www.kaggle.com/carlmcbrideellis">Carl</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us look at the most important feature, 'feature_0'</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;feature_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre> 1    1207005
-1    1183486
Name: feature_0, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Interestingly, when feature_0 is 1, plot shows negative slope while in contrast, when feature_0 is -1, plot shows positive slope. My guess is that feature_0 corresponds to Buy(1) and Sell(-1) or vice versa. So if we set action to 1 with feature_0 = 1 then we are selling and when we set action to 0 with feature_0 = -1, then we are buying. This makes sense since whether we are buying or selling we can still lose or gain profit.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Features">Features<a class="anchor-link" href="#Features"> </a></h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us see what tag_0 groups tells us.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Correlation between features of tag_0. It looks like there certainly are correlation between elements of the group except a few.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Interesting points:</p>
<ul>
<li>feature_0 has no tags</li>
<li>feature 79 to 119 all has 4 tags</li>
<li>feature 7 to 36 have 3 and 4 tags periodically</li>
<li>Similar trend between 2 to 7, 37 to 40, 120 to 129</li>
<li>tag_n doesn't tell too much about the features</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reference">Reference<a class="anchor-link" href="#Reference"> </a></h3><ul>
<li><a href="https://www.kaggle.com/carlmcbrideellis/jane-street-eda-of-day-0-and-feature-importance">Jane Street: EDA of day 0 and feature importance</a></li>
<li><a href="https://www.kaggle.com/muhammadmelsherbini/jane-street-extensive-eda-pca-starter">Jane_street_Extensive_EDA &amp; PCA starter üìä‚ö°</a></li>
<li><a href="https://www.kaggle.com/hamzashabbirbhatti/eda-a-quant-s-prespective#Weight">EDA / A Quant's Prespective</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Submission">Submission<a class="anchor-link" href="#Submission"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In another notebook. Thoughts going into predicting phase.</p>
<ol>
<li>Days before ~100 can be dropped as suspicion of model shift.</li>
<li>Feature_0 seem very important to find slope of cummulative resp.</li>
<li>Resp near 0 is prefered over other values.</li>
<li>A lot of features are normally distributed.</li>
<li>We have over 2 million datas, it would be safe to add lot more features(feature enginerring)</li>
<li>There are a lot of missing values too. Can try mean, median or KNN imputation methods.</li>
<li>Note that although this is kind of a time series data, we can only predict with features 0 to 129</li>
</ol>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/jaekangai/2021/01/23/jane.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/jaekangai/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/jaekangai/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/jaekangai/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>‚ù§</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/leejaeka" title="leejaeka"><svg class="svg-icon grey"><use xlink:href="/jaekangai/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/jaekang-lee" title="jaekang-lee"><svg class="svg-icon grey"><use xlink:href="/jaekangai/assets/minima-social-icons.svg#linkedin"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
